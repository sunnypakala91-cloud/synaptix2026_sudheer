<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Assessment Result</title>

<style>
body{
    margin:0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    color:white;
}
.header{
    padding:20px;
    text-align:center;
    font-size:28px;
    font-weight:bold;
    letter-spacing:1px;
}
.container{
    max-width:900px;
    margin:30px auto;
    padding:20px;
}
.cards{
    display:grid;
    grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
    gap:20px;
}
.card{
    background: rgba(255,255,255,0.08);
    padding:20px;
    border-radius:12px;
    backdrop-filter: blur(8px);
    box-shadow:0 0 15px rgba(0,0,0,0.4);
    transition:0.3s;
}
.card:hover{
    transform:scale(1.05);
}
.label{
    font-size:14px;
    color:#aaa;
}
.value{
    font-size:22px;
    margin-top:5px;
    font-weight:bold;
}
.status{
    text-align:center;
    margin-top:30px;
    font-size:22px;
    font-weight:bold;
    color:#00ffcc;
}
.feedback{
    margin-top:40px;
    text-align:center;
}
.feedback textarea{
    width:80%;
    padding:10px;
    margin:8px 0;
    border-radius:8px;
    border:none;
    outline:none;
    font-size:16px;
    resize:none;
    height:100px;
}
.btn{
    display:block;
    margin:20px auto;
    padding:12px 30px;
    border:none;
    border-radius:8px;
    background:#00ffcc;
    color:black;
    font-size:16px;
    cursor:pointer;
    font-weight:bold;
}
.btn:hover{
    background:#00ccaa;
}
.btn:disabled{
    background:gray;
    cursor:not-allowed;
}
.submitted-feedback{
    color:#5eff00;
    font-weight:bold;
    margin-top:10px;
}
</style>
</head>
<body>

<div class="header">
Assessment Result
</div>

<div class="container">

<div class="cards">
<div class="card">
<div class="label">Student Name</div>
<div class="value" id="studentName">Student</div>
</div>

<div class="card">
<div class="label">Correct Answers</div>
<div class="value" id="correct">0</div>
</div>

<div class="card">
<div class="label">Wrong Answers</div>
<div class="value" id="wrong">0</div>
</div>

<div class="card">
<div class="label">Not Attempted</div>
<div class="value" id="notAttempted">0</div>
</div>

<div class="card">
<div class="label">Accuracy</div>
<div class="value" id="accuracy">0%</div>
</div>
</div>

<div class="status" id="status">Performance</div>

<div class="feedback">
<h3>Feedback (required to go home)</h3>
<textarea id="fbMessage" placeholder="Write your feedback"></textarea><br/>
<button class="btn" id="submitFeedbackBtn" onclick="submitFeedback()">Submit Feedback</button>
<div class="submitted-feedback" id="feedbackStatus"></div>
<button class="btn" id="homeBtn" onclick="goHome()" disabled>Back to Home</button>
</div>

</div>

<script>
// Retrieve score and answers from localStorage
let score = parseInt(localStorage.getItem("score")) || 0;
let answers = JSON.parse(localStorage.getItem("answers")) || [];
let name = localStorage.getItem("studentName") || "Student";

// Count not attempted questions
let notAttempted = answers.filter(a => a.selected === "No Answer").length;
let wrong = answers.filter(a => a.selected !== a.correct && a.selected !== "No Answer").length;
let correct = score;
let total = answers.length;
let accuracy = total > 0 ? Math.round((correct / total) * 100) : 0;

// Update DOM
document.getElementById("studentName").innerText = name;
document.getElementById("correct").innerText = correct;
document.getElementById("wrong").innerText = wrong;
document.getElementById("notAttempted").innerText = notAttempted;
document.getElementById("accuracy").innerText = accuracy + "%";

// Performance message
let statusMsg = "Needs Improvement";
if(correct >= 25) statusMsg = "Excellent Performance üî•";
else if(correct >= 15) statusMsg = "Good Performance üëç";
document.getElementById("status").innerText = statusMsg;

// Feedback functions
function submitFeedback(){
    let fbMsg = document.getElementById("fbMessage").value.trim();
    if(fbMsg==""){
        alert("Please provide your feedback before submitting.");
        return;
    }
    let allFeedback = JSON.parse(localStorage.getItem("feedback")) || [];
    allFeedback.push({message:fbMsg});
    localStorage.setItem("feedback", JSON.stringify(allFeedback));
    document.getElementById("fbMessage").readOnly = true;
    document.getElementById("submitFeedbackBtn").disabled = true;
    document.getElementById("feedbackStatus").innerText = "Feedback submitted ‚úì";
    document.getElementById("homeBtn").disabled = false;
}

function goHome(){
    window.location.href = "index.html";
}
</script>

</body>
</html>
